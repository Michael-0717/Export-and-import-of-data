# Экспорт и импорт данных
## Постановка задачи
Подготовим данные для построения модели: получим, объединим, оптимизируем и обогатим данные.
Сохраним готовые данные в нескольких форматах: CSV, HDF5
Данные:
•	http://video.ittensive.com/machine-learning/ashrae/building_metadata.csv.gz
•	http://video.ittensive.com/machine-learning/ashrae/weather_train.csv.gz
•	http://video.ittensive.com/machine-learning/ashrae/train.0.csv.gz Соревнование: https://www.kaggle.com/c/ashrae-energy-prediction/
© ITtensive, 2020
___
## Решение.
1) Подключим нужные библиотекию. Осуществим загрузку данных, отсечение 20 зданий, объединение и оптимизация.
Выведем размеры вещественных и целых размеров данных numpy.
Основные вещественные типы имеют точность 3 и 7 знаков после запятой
и размер 2 и 4 байта соответственно. - float
Целые типы используют от 1 до 4 байт в зависимости от диапазона значений. - int
Для вывода типа данных используем этого сокращенное название, например:
Вещественные числа: "f2", "f4" – float 2 и 4 байта
Без объединения оптимизации исходные данные по энергопотреблению занимают порядка 400 Мб, при построении зависимостей моделей этой объем памяти может увеличиваться на 1-2 порядка. Поэтому нам требуется максимально уменьшить объем памяти, для этого используем функцию оптимизации памяти для наших нужд. В ней проверим исходный тип данных и уменьшим его размер, если диапазон данных это позволяет.
2) Интерполяция значений.
3) Обогащение данных: погода.
4) Объединение погодных данных.
5) Обогащение данных: дата.
6) Логарифмирование данных
z = A * x + B * y -> log z = A * x + B * y => z = e^Ax * e^By => z = a^x * b^y.
7) Экспорт данных в CSV и HDF5. 
Формат CSV позволяет сохранять данные в сжатом виде.
Прочитаем данные сохраненные в csv. Все данные загрузились, но типы дат снова приняли значения по умолчанию, т.е. потребуется заново оптимизировать набор данных по памяти после импорта из csv формата.
Посмотрим на формат HDF5, он является иерархическим и бинарным. Данные сохраняются по группам, которые могут иметь метаданные (дополнительная информация, зашифрованная в структуре самого файла), доступные через атрибуты групп. Перед сохранением в HDF5 – формате заново оптимизируем наш набор данных и запишем его, используя сжатие данных.
8) Экспорт данных в HDF5.
9) Вывод: кроме очевидного уменьшения размера хранимых данных,  чтение в формате быстрее. Это формат оптимизирован для быстрой и частичной загрузки данных, а также для фильтрации и срезов по этим данным. После загрузки из HDF5 – формата данные полностью сохраняются. Дополнительно проводить оптимизацию не требуется. 
Дополнительно в HDF5 можно сохранить несколько наборов данных. Выполним это для обучающих и проверочных выборок, а также запишем в файл дополнительные данные как еще один набор данных.
10) Разделение данных и экспорт в HDF5.
Для корректной записи данных выставим настройку pandos, отвечающая за формат записи HDF5 по умолчанию в табличный. Для хранения атрибутов набора данных так же можно использовать свойства у объекта HDF5.
Для хранения атрибутов наборов данных также можно использовать store.get_storer('energy_train').attrs.my_attr
11) Чтение из HDF5.
При чтении из HDF5 данные полностью сохраняются. Разделение данных на обучающие и проверочные вернет те же значения, что и собрание.
При работе с загрузкой данных из HDF5 необходимо использовать срезы, чтобы загрузить все данные, переменные и не потерять их после закрытия объекта хранилища.
 

